Metadata-Version: 2.1
Name: beets-ytimport
Version: 0.3.0
Summary: Download audio from Youtube into your Beets library
Home-page: https://github.com/mgoltzsche/beets-ytimport
Author: Max Goltzsche
License: UNKNOWN
Platform: UNKNOWN
Classifier: Programming Language :: Python :: 3.6
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Operating System :: OS Independent
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: beets
Requires-Dist: ytmusicapi
Requires-Dist: yt-dlp

# beets-ytimport

A [Beets](https://github.com/beetbox/beets) plugin to download audio from [Youtube](https://www.youtube.com/) and import it into your library.

Differences compared to the [ydl plugin](https://github.com/vmassuchetto/beets-ydl):
* Supports downloading liked songs into your Beets library (using [ytmusicapi](https://github.com/sigma67/ytmusicapi)).
* Stores m4a files instead of mp3 to avoid re-encoding lossy audio (which would decrease quality).
* Uses [yt-dlp](https://github.com/yt-dlp/yt-dlp) instead of [ytdl](https://github.com/ytdl-org/youtube-dl) to download the audio files.

## Installation

```sh
python3 -m pip install beets-ytimport ytmusicapi yt-dlp slugify
```

## Configuration

Enable the plugin and add a `ytimport` section to your Beets `config.yaml` as follows:
```yaml
plugins:
  - ytimport

ytimport:
  directory: /path/to/youtube/cache # required
  import: true
  likes: false
  max_likes: 50
  set: 'mykey=myvalue'
  auth_headers: /path/to/your/http/headers
  min_len: 60
  max_len: 7200
  split_albums: true
```

For more information, see [CLI](#cli).

## Usage

Once you enabled the `ytimport` plugin within your Beets configuration, you can download your liked songs from Youtube and import them into your Beets library as follows:
```sh
beet ytimport --likes --max-likes 1500
```

Please note that the command prompts you for Google authentication, unless you specified the `auth_headers` option within your Beets configuration file pointing to a file containing HTTP headers (to get the HTTP headers, see [here](https://ytmusicapi.readthedocs.io/en/stable/setup/browser.html#copy-authentication-headers)).
Import auto-tagger prompts can be disabled by specifying the `-q` option.
You can interrupt and continue or repeat the command to synchronize likes from your Youtube account(s) into your Beets library incrementally.

To download a particular track, run:
```sh
beet ytimport --nolikes https://www.youtube.com/watch?v=hC8CH0Z3L54
```

### CLI

```
Usage: beet ytimport [options]

Options:
  -h, --help            show this help message and exit
  --directory=DIRECTORY
                        directory to download Youtube files to
  --auth-headers=AUTH_HEADERS
                        path to a file containing the HTTP headers of an
                        authenticated POST request to music.youtube.com,
                        copied from your browser's development tool
  --likes               download liked songs
  --nolikes             don't download liked songs
  --max-likes=MAX_LIKES
                        maximum number of likes to obtain
  --split-albums        split albums into tracks
  --nosplit-albums      don't split albums into tracks
  --import              import downloaded songs into beets
  --noimport            don't import downloaded songs into beets
  --set=SET             set a field on import, using FIELD=VALUE format
  --min-len=MIN_LEN     minimum track length in seconds
  --max-len=MAX_LEN     maximum track length in seconds
  -q, --quiet           don't prompt for input when importing
  --pretend             don't import but print the files when importing
```

## Development

Run the unit tests (containerized):
```sh
make test
```

Run the e2e tests (containerized):
```sh
make test-e2e
```

To test your plugin changes manually, you can run a shell within a Beets docker container as follows:
```sh
make beets-sh
```

For testing purposes the Beets library is written to `./data`.


