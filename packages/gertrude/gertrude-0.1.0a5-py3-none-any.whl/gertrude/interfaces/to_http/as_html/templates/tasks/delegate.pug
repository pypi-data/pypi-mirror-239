//- Gertrude --- GTD done right
//- Copyright Â© 2023 Tanguy Le Carrour <tanguy@bioneland.org>
//-
//- This program is free software: you can redistribute it and/or modify
//- it under the terms of the GNU Affero General Public License as
//- published by the Free Software Foundation, either version 3 of the
//- License, or (at your option) any later version.
//-
//- This program is distributed in the hope that it will be useful,
//- but WITHOUT ANY WARRANTY; without even the implied warranty of
//- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//- GNU Affero General Public License for more details.
//-
//- You should have received a copy of the GNU Affero General Public License
//- along with this program. If not, see <http://www.gnu.org/licenses/>.

extends layout

block modal
  .modal.is-active(_="on closeModal remove me")
    .modal-background(_="on click trigger closeModal then halt default")
    .modal-card
      header.modal-card-head
        p.modal-card-title Delegate task to a person
        a.delete(
          href=url_for("tasks.display", id=id)
          _="on click trigger closeModal then halt default"
          aria-label="close"
        )

      section.modal-card-body
        article.message.is-warning: .message-body: p
          | #[strong WIP:] for the time being use #[code 00000000-0000-0000-0000-000000000000].

        form(
          method="POST"
          action=url_for("tasks.delegate", id=task.id)
          hx-post=url_for("tasks.delegate", id=task.id)
          hx-target="#modal"
        )
          input(type="hidden" name="id" value=task.id)

          .field
            - var classes = "is-danger" if errors.delegated_to else ""
            label.label Person
            .control: input.input(
              type="text"
              name="delegated_to"
              value=task.delegated_to
              class=classes
              placeholder="Name of the person to delegate to"
            )
            if errors.delegated_to
              p.help.is-danger= errors.delegated_to

          .field.is-grouped
            .control
              a.button(
                href=url_for("tasks.display", id=task.id)
                _="on click trigger closeModal then halt default"
              )
                span.icon: i.fas.fa-ban(aria-hidden="true")
                span Cancel
            .control: button.button.is-success(type="submit")
              span.icon: i.fas.fa-coffee(aria-hidden="true")
              span Delegate
