!function(){"use strict";$(function(){var e=$("#id_asana_access_token"),n=$("#id_asana_workspace"),a=$('<div class="errorlist">').insertAfter(e).hide(),t=(n.selectize({create:!1,dropdownParent:"body",searchField:"name",valueField:"id",labelField:"name",render:{option:function(e,n){return"<div>".concat(n(e.name),"</div>")}},onChange:function(e){$("#id_asana_workspace_name").val(this.options[e].name)}}),n[0].selectize);function o(e){a.html('<span class="rb-icon rb-icon-warning"></span>\n'.concat(_.escape(e))).show()}t.$control.width($("#id_name").width()),t.disable();var r=null,n=_.throttle(function(){var n=e.val().trim();r!==n&&(r=n,a.hide(),t.disable(),0!==n.length)&&t.load(function(r){var e=$.param({api_key:n});$.ajax({url:"".concat(SITE_ROOT,"rbintegrations/asana/workspaces/?").concat(e),type:"GET",success:function(e){"success"===e.result?(t.enable(),r(e.data)):("error"===e.result?o(e.error):(console.error("Unexpected error when fetching Asana workspace list",e),o("Unable to communicate with Asana")),r())},error:function(e,n,a){console.error("Unexpected error when fetching Asana workspace list",e),o("Unable to communicate with Asana"),r()}})})},100);e.on("change keyup",n),n()})}.call(this);
