"use strict";
(self["webpackChunk_jupyterlab_application_top"] = self["webpackChunk_jupyterlab_application_top"] || []).push([["node_modules_codemirror_legacy-modes_mode_stex_js"],{

/***/ "../node_modules/@codemirror/legacy-modes/mode/stex.js":
/*!*************************************************************!*\
  !*** ../node_modules/@codemirror/legacy-modes/mode/stex.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "stex": () => (/* binding */ stex),
/* harmony export */   "stexMath": () => (/* binding */ stexMath)
/* harmony export */ });
function mkStex(mathMode) {
  function pushCommand(state, command) {
    state.cmdState.push(command);
  }

  function peekCommand(state) {
    if (state.cmdState.length > 0) {
      return state.cmdState[state.cmdState.length - 1];
    } else {
      return null;
    }
  }

  function popCommand(state) {
    var plug = state.cmdState.pop();
    if (plug) {
      plug.closeBracket();
    }
  }

  // returns the non-default plugin closest to the end of the list
  function getMostPowerful(state) {
    var context = state.cmdState;
    for (var i = context.length - 1; i >= 0; i--) {
      var plug = context[i];
      if (plug.name == "DEFAULT") {
        continue;
      }
      return plug;
    }
    return { styleIdentifier: function() { return null; } };
  }

  function addPluginPattern(pluginName, cmdStyle, styles) {
    return function () {
      this.name = pluginName;
      this.bracketNo = 0;
      this.style = cmdStyle;
      this.styles = styles;
      this.argument = null;   // \begin and \end have arguments that follow. These are stored in the plugin

      this.styleIdentifier = function() {
        return this.styles[this.bracketNo - 1] || null;
      };
      this.openBracket = function() {
        this.bracketNo++;
        return "bracket";
      };
      this.closeBracket = function() {};
    };
  }

  var plugins = {};

  plugins["importmodule"] = addPluginPattern("importmodule", "tag", ["string", "builtin"]);
  plugins["documentclass"] = addPluginPattern("documentclass", "tag", ["", "atom"]);
  plugins["usepackage"] = addPluginPattern("usepackage", "tag", ["atom"]);
  plugins["begin"] = addPluginPattern("begin", "tag", ["atom"]);
  plugins["end"] = addPluginPattern("end", "tag", ["atom"]);

  plugins["label"    ] = addPluginPattern("label"    , "tag", ["atom"]);
  plugins["ref"      ] = addPluginPattern("ref"      , "tag", ["atom"]);
  plugins["eqref"    ] = addPluginPattern("eqref"    , "tag", ["atom"]);
  plugins["cite"     ] = addPluginPattern("cite"     , "tag", ["atom"]);
  plugins["bibitem"  ] = addPluginPattern("bibitem"  , "tag", ["atom"]);
  plugins["Bibitem"  ] = addPluginPattern("Bibitem"  , "tag", ["atom"]);
  plugins["RBibitem" ] = addPluginPattern("RBibitem" , "tag", ["atom"]);

  plugins["DEFAULT"] = function () {
    this.name = "DEFAULT";
    this.style = "tag";

    this.styleIdentifier = this.openBracket = this.closeBracket = function() {};
  };

  function setState(state, f) {
    state.f = f;
  }

  // called when in a normal (no environment) context
  function normal(source, state) {
    var plug;
    // Do we look like '\command' ?  If so, attempt to apply the plugin 'command'
    if (source.match(/^\\[a-zA-Z@\xc0-\u1fff\u2060-\uffff]+/)) {
      var cmdName = source.current().slice(1);
      plug = plugins.hasOwnProperty(cmdName) ? plugins[cmdName] : plugins["DEFAULT"];
      plug = new plug();
      pushCommand(state, plug);
      setState(state, beginParams);
      return plug.style;
    }

    // escape characters
    if (source.match(/^\\[$&%#{}_]/)) {
      return "tag";
    }

    // white space control characters
    if (source.match(/^\\[,;!\/\\]/)) {
      return "tag";
    }

    // find if we're starting various math modes
    if (source.match("\\[")) {
      setState(state, function(source, state){ return inMathMode(source, state, "\\]"); });
      return "keyword";
    }
    if (source.match("\\(")) {
      setState(state, function(source, state){ return inMathMode(source, state, "\\)"); });
      return "keyword";
    }
    if (source.match("$$")) {
      setState(state, function(source, state){ return inMathMode(source, state, "$$"); });
      return "keyword";
    }
    if (source.match("$")) {
      setState(state, function(source, state){ return inMathMode(source, state, "$"); });
      return "keyword";
    }

    var ch = source.next();
    if (ch == "%") {
      source.skipToEnd();
      return "comment";
    } else if (ch == '}' || ch == ']') {
      plug = peekCommand(state);
      if (plug) {
        plug.closeBracket(ch);
        setState(state, beginParams);
      } else {
        return "error";
      }
      return "bracket";
    } else if (ch == '{' || ch == '[') {
      plug = plugins["DEFAULT"];
      plug = new plug();
      pushCommand(state, plug);
      return "bracket";
    } else if (/\d/.test(ch)) {
      source.eatWhile(/[\w.%]/);
      return "atom";
    } else {
      source.eatWhile(/[\w\-_]/);
      plug = getMostPowerful(state);
      if (plug.name == 'begin') {
        plug.argument = source.current();
      }
      return plug.styleIdentifier();
    }
  }

  function inMathMode(source, state, endModeSeq) {
    if (source.eatSpace()) {
      return null;
    }
    if (endModeSeq && source.match(endModeSeq)) {
      setState(state, normal);
      return "keyword";
    }
    if (source.match(/^\\[a-zA-Z@]+/)) {
      return "tag";
    }
    if (source.match(/^[a-zA-Z]+/)) {
      return "variableName.special";
    }
    // escape characters
    if (source.match(/^\\[$&%#{}_]/)) {
      return "tag";
    }
    // white space control characters
    if (source.match(/^\\[,;!\/]/)) {
      return "tag";
    }
    // special math-mode characters
    if (source.match(/^[\^_&]/)) {
      return "tag";
    }
    // non-special characters
    if (source.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)) {
      return null;
    }
    if (source.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)) {
      return "number";
    }
    var ch = source.next();
    if (ch == "{" || ch == "}" || ch == "[" || ch == "]" || ch == "(" || ch == ")") {
      return "bracket";
    }

    if (ch == "%") {
      source.skipToEnd();
      return "comment";
    }
    return "error";
  }

  function beginParams(source, state) {
    var ch = source.peek(), lastPlug;
    if (ch == '{' || ch == '[') {
      lastPlug = peekCommand(state);
      lastPlug.openBracket(ch);
      source.eat(ch);
      setState(state, normal);
      return "bracket";
    }
    if (/[ \t\r]/.test(ch)) {
      source.eat(ch);
      return null;
    }
    setState(state, normal);
    popCommand(state);

    return normal(source, state);
  }

  return {
    name: "stex",
    startState: function() {
      var f = mathMode ? function(source, state){ return inMathMode(source, state); } : normal;
      return {
        cmdState: [],
        f: f
      };
    },
    copyState: function(s) {
      return {
        cmdState: s.cmdState.slice(),
        f: s.f
      };
    },
    token: function(stream, state) {
      return state.f(stream, state);
    },
    blankLine: function(state) {
      state.f = normal;
      state.cmdState.length = 0;
    },
    languageData: {
      commentTokens: {line: "%"}
    }
  };
};

const stex = mkStex(false)
const stexMath = mkStex(true)


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2NvZGVtaXJyb3JfbGVnYWN5LW1vZGVzX21vZGVfc3RleF9qcy44Y2MwNzA1YTZjZmRkNzRkMzNmOS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxRQUFRO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsOEJBQThCO0FBQzNDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qjs7QUFFOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0NBQStDLDBDQUEwQztBQUN6RjtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsMENBQTBDO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyx5Q0FBeUM7QUFDeEY7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHdDQUF3QztBQUN2RjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxpQkFBaUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTSxpQkFBaUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGFBQWE7QUFDN0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0Qsb0NBQW9DO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBOztBQUVPO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AanVweXRlcmxhYi9hcHBsaWNhdGlvbi10b3AvLi4vbm9kZV9tb2R1bGVzL0Bjb2RlbWlycm9yL2xlZ2FjeS1tb2Rlcy9tb2RlL3N0ZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbWtTdGV4KG1hdGhNb2RlKSB7XG4gIGZ1bmN0aW9uIHB1c2hDb21tYW5kKHN0YXRlLCBjb21tYW5kKSB7XG4gICAgc3RhdGUuY21kU3RhdGUucHVzaChjb21tYW5kKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBlZWtDb21tYW5kKHN0YXRlKSB7XG4gICAgaWYgKHN0YXRlLmNtZFN0YXRlLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBzdGF0ZS5jbWRTdGF0ZVtzdGF0ZS5jbWRTdGF0ZS5sZW5ndGggLSAxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcG9wQ29tbWFuZChzdGF0ZSkge1xuICAgIHZhciBwbHVnID0gc3RhdGUuY21kU3RhdGUucG9wKCk7XG4gICAgaWYgKHBsdWcpIHtcbiAgICAgIHBsdWcuY2xvc2VCcmFja2V0KCk7XG4gICAgfVxuICB9XG5cbiAgLy8gcmV0dXJucyB0aGUgbm9uLWRlZmF1bHQgcGx1Z2luIGNsb3Nlc3QgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdFxuICBmdW5jdGlvbiBnZXRNb3N0UG93ZXJmdWwoc3RhdGUpIHtcbiAgICB2YXIgY29udGV4dCA9IHN0YXRlLmNtZFN0YXRlO1xuICAgIGZvciAodmFyIGkgPSBjb250ZXh0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgcGx1ZyA9IGNvbnRleHRbaV07XG4gICAgICBpZiAocGx1Zy5uYW1lID09IFwiREVGQVVMVFwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBsdWc7XG4gICAgfVxuICAgIHJldHVybiB7IHN0eWxlSWRlbnRpZmllcjogZnVuY3Rpb24oKSB7IHJldHVybiBudWxsOyB9IH07XG4gIH1cblxuICBmdW5jdGlvbiBhZGRQbHVnaW5QYXR0ZXJuKHBsdWdpbk5hbWUsIGNtZFN0eWxlLCBzdHlsZXMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5uYW1lID0gcGx1Z2luTmFtZTtcbiAgICAgIHRoaXMuYnJhY2tldE5vID0gMDtcbiAgICAgIHRoaXMuc3R5bGUgPSBjbWRTdHlsZTtcbiAgICAgIHRoaXMuc3R5bGVzID0gc3R5bGVzO1xuICAgICAgdGhpcy5hcmd1bWVudCA9IG51bGw7ICAgLy8gXFxiZWdpbiBhbmQgXFxlbmQgaGF2ZSBhcmd1bWVudHMgdGhhdCBmb2xsb3cuIFRoZXNlIGFyZSBzdG9yZWQgaW4gdGhlIHBsdWdpblxuXG4gICAgICB0aGlzLnN0eWxlSWRlbnRpZmllciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZXNbdGhpcy5icmFja2V0Tm8gLSAxXSB8fCBudWxsO1xuICAgICAgfTtcbiAgICAgIHRoaXMub3BlbkJyYWNrZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5icmFja2V0Tm8rKztcbiAgICAgICAgcmV0dXJuIFwiYnJhY2tldFwiO1xuICAgICAgfTtcbiAgICAgIHRoaXMuY2xvc2VCcmFja2V0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICB9O1xuICB9XG5cbiAgdmFyIHBsdWdpbnMgPSB7fTtcblxuICBwbHVnaW5zW1wiaW1wb3J0bW9kdWxlXCJdID0gYWRkUGx1Z2luUGF0dGVybihcImltcG9ydG1vZHVsZVwiLCBcInRhZ1wiLCBbXCJzdHJpbmdcIiwgXCJidWlsdGluXCJdKTtcbiAgcGx1Z2luc1tcImRvY3VtZW50Y2xhc3NcIl0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwiZG9jdW1lbnRjbGFzc1wiLCBcInRhZ1wiLCBbXCJcIiwgXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcInVzZXBhY2thZ2VcIl0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwidXNlcGFja2FnZVwiLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcImJlZ2luXCJdID0gYWRkUGx1Z2luUGF0dGVybihcImJlZ2luXCIsIFwidGFnXCIsIFtcImF0b21cIl0pO1xuICBwbHVnaW5zW1wiZW5kXCJdID0gYWRkUGx1Z2luUGF0dGVybihcImVuZFwiLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcblxuICBwbHVnaW5zW1wibGFiZWxcIiAgICBdID0gYWRkUGx1Z2luUGF0dGVybihcImxhYmVsXCIgICAgLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcInJlZlwiICAgICAgXSA9IGFkZFBsdWdpblBhdHRlcm4oXCJyZWZcIiAgICAgICwgXCJ0YWdcIiwgW1wiYXRvbVwiXSk7XG4gIHBsdWdpbnNbXCJlcXJlZlwiICAgIF0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwiZXFyZWZcIiAgICAsIFwidGFnXCIsIFtcImF0b21cIl0pO1xuICBwbHVnaW5zW1wiY2l0ZVwiICAgICBdID0gYWRkUGx1Z2luUGF0dGVybihcImNpdGVcIiAgICAgLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcImJpYml0ZW1cIiAgXSA9IGFkZFBsdWdpblBhdHRlcm4oXCJiaWJpdGVtXCIgICwgXCJ0YWdcIiwgW1wiYXRvbVwiXSk7XG4gIHBsdWdpbnNbXCJCaWJpdGVtXCIgIF0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwiQmliaXRlbVwiICAsIFwidGFnXCIsIFtcImF0b21cIl0pO1xuICBwbHVnaW5zW1wiUkJpYml0ZW1cIiBdID0gYWRkUGx1Z2luUGF0dGVybihcIlJCaWJpdGVtXCIgLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcblxuICBwbHVnaW5zW1wiREVGQVVMVFwiXSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm5hbWUgPSBcIkRFRkFVTFRcIjtcbiAgICB0aGlzLnN0eWxlID0gXCJ0YWdcIjtcblxuICAgIHRoaXMuc3R5bGVJZGVudGlmaWVyID0gdGhpcy5vcGVuQnJhY2tldCA9IHRoaXMuY2xvc2VCcmFja2V0ID0gZnVuY3Rpb24oKSB7fTtcbiAgfTtcblxuICBmdW5jdGlvbiBzZXRTdGF0ZShzdGF0ZSwgZikge1xuICAgIHN0YXRlLmYgPSBmO1xuICB9XG5cbiAgLy8gY2FsbGVkIHdoZW4gaW4gYSBub3JtYWwgKG5vIGVudmlyb25tZW50KSBjb250ZXh0XG4gIGZ1bmN0aW9uIG5vcm1hbChzb3VyY2UsIHN0YXRlKSB7XG4gICAgdmFyIHBsdWc7XG4gICAgLy8gRG8gd2UgbG9vayBsaWtlICdcXGNvbW1hbmQnID8gIElmIHNvLCBhdHRlbXB0IHRvIGFwcGx5IHRoZSBwbHVnaW4gJ2NvbW1hbmQnXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlxcXFxbYS16QS1aQFxceGMwLVxcdTFmZmZcXHUyMDYwLVxcdWZmZmZdKy8pKSB7XG4gICAgICB2YXIgY21kTmFtZSA9IHNvdXJjZS5jdXJyZW50KCkuc2xpY2UoMSk7XG4gICAgICBwbHVnID0gcGx1Z2lucy5oYXNPd25Qcm9wZXJ0eShjbWROYW1lKSA/IHBsdWdpbnNbY21kTmFtZV0gOiBwbHVnaW5zW1wiREVGQVVMVFwiXTtcbiAgICAgIHBsdWcgPSBuZXcgcGx1ZygpO1xuICAgICAgcHVzaENvbW1hbmQoc3RhdGUsIHBsdWcpO1xuICAgICAgc2V0U3RhdGUoc3RhdGUsIGJlZ2luUGFyYW1zKTtcbiAgICAgIHJldHVybiBwbHVnLnN0eWxlO1xuICAgIH1cblxuICAgIC8vIGVzY2FwZSBjaGFyYWN0ZXJzXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlxcXFxbJCYlI3t9X10vKSkge1xuICAgICAgcmV0dXJuIFwidGFnXCI7XG4gICAgfVxuXG4gICAgLy8gd2hpdGUgc3BhY2UgY29udHJvbCBjaGFyYWN0ZXJzXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlxcXFxbLDshXFwvXFxcXF0vKSkge1xuICAgICAgcmV0dXJuIFwidGFnXCI7XG4gICAgfVxuXG4gICAgLy8gZmluZCBpZiB3ZSdyZSBzdGFydGluZyB2YXJpb3VzIG1hdGggbW9kZXNcbiAgICBpZiAoc291cmNlLm1hdGNoKFwiXFxcXFtcIikpIHtcbiAgICAgIHNldFN0YXRlKHN0YXRlLCBmdW5jdGlvbihzb3VyY2UsIHN0YXRlKXsgcmV0dXJuIGluTWF0aE1vZGUoc291cmNlLCBzdGF0ZSwgXCJcXFxcXVwiKTsgfSk7XG4gICAgICByZXR1cm4gXCJrZXl3b3JkXCI7XG4gICAgfVxuICAgIGlmIChzb3VyY2UubWF0Y2goXCJcXFxcKFwiKSkge1xuICAgICAgc2V0U3RhdGUoc3RhdGUsIGZ1bmN0aW9uKHNvdXJjZSwgc3RhdGUpeyByZXR1cm4gaW5NYXRoTW9kZShzb3VyY2UsIHN0YXRlLCBcIlxcXFwpXCIpOyB9KTtcbiAgICAgIHJldHVybiBcImtleXdvcmRcIjtcbiAgICB9XG4gICAgaWYgKHNvdXJjZS5tYXRjaChcIiQkXCIpKSB7XG4gICAgICBzZXRTdGF0ZShzdGF0ZSwgZnVuY3Rpb24oc291cmNlLCBzdGF0ZSl7IHJldHVybiBpbk1hdGhNb2RlKHNvdXJjZSwgc3RhdGUsIFwiJCRcIik7IH0pO1xuICAgICAgcmV0dXJuIFwia2V5d29yZFwiO1xuICAgIH1cbiAgICBpZiAoc291cmNlLm1hdGNoKFwiJFwiKSkge1xuICAgICAgc2V0U3RhdGUoc3RhdGUsIGZ1bmN0aW9uKHNvdXJjZSwgc3RhdGUpeyByZXR1cm4gaW5NYXRoTW9kZShzb3VyY2UsIHN0YXRlLCBcIiRcIik7IH0pO1xuICAgICAgcmV0dXJuIFwia2V5d29yZFwiO1xuICAgIH1cblxuICAgIHZhciBjaCA9IHNvdXJjZS5uZXh0KCk7XG4gICAgaWYgKGNoID09IFwiJVwiKSB7XG4gICAgICBzb3VyY2Uuc2tpcFRvRW5kKCk7XG4gICAgICByZXR1cm4gXCJjb21tZW50XCI7XG4gICAgfSBlbHNlIGlmIChjaCA9PSAnfScgfHwgY2ggPT0gJ10nKSB7XG4gICAgICBwbHVnID0gcGVla0NvbW1hbmQoc3RhdGUpO1xuICAgICAgaWYgKHBsdWcpIHtcbiAgICAgICAgcGx1Zy5jbG9zZUJyYWNrZXQoY2gpO1xuICAgICAgICBzZXRTdGF0ZShzdGF0ZSwgYmVnaW5QYXJhbXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFwiZXJyb3JcIjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBcImJyYWNrZXRcIjtcbiAgICB9IGVsc2UgaWYgKGNoID09ICd7JyB8fCBjaCA9PSAnWycpIHtcbiAgICAgIHBsdWcgPSBwbHVnaW5zW1wiREVGQVVMVFwiXTtcbiAgICAgIHBsdWcgPSBuZXcgcGx1ZygpO1xuICAgICAgcHVzaENvbW1hbmQoc3RhdGUsIHBsdWcpO1xuICAgICAgcmV0dXJuIFwiYnJhY2tldFwiO1xuICAgIH0gZWxzZSBpZiAoL1xcZC8udGVzdChjaCkpIHtcbiAgICAgIHNvdXJjZS5lYXRXaGlsZSgvW1xcdy4lXS8pO1xuICAgICAgcmV0dXJuIFwiYXRvbVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBzb3VyY2UuZWF0V2hpbGUoL1tcXHdcXC1fXS8pO1xuICAgICAgcGx1ZyA9IGdldE1vc3RQb3dlcmZ1bChzdGF0ZSk7XG4gICAgICBpZiAocGx1Zy5uYW1lID09ICdiZWdpbicpIHtcbiAgICAgICAgcGx1Zy5hcmd1bWVudCA9IHNvdXJjZS5jdXJyZW50KCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGx1Zy5zdHlsZUlkZW50aWZpZXIoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpbk1hdGhNb2RlKHNvdXJjZSwgc3RhdGUsIGVuZE1vZGVTZXEpIHtcbiAgICBpZiAoc291cmNlLmVhdFNwYWNlKCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAoZW5kTW9kZVNlcSAmJiBzb3VyY2UubWF0Y2goZW5kTW9kZVNlcSkpIHtcbiAgICAgIHNldFN0YXRlKHN0YXRlLCBub3JtYWwpO1xuICAgICAgcmV0dXJuIFwia2V5d29yZFwiO1xuICAgIH1cbiAgICBpZiAoc291cmNlLm1hdGNoKC9eXFxcXFthLXpBLVpAXSsvKSkge1xuICAgICAgcmV0dXJuIFwidGFnXCI7XG4gICAgfVxuICAgIGlmIChzb3VyY2UubWF0Y2goL15bYS16QS1aXSsvKSkge1xuICAgICAgcmV0dXJuIFwidmFyaWFibGVOYW1lLnNwZWNpYWxcIjtcbiAgICB9XG4gICAgLy8gZXNjYXBlIGNoYXJhY3RlcnNcbiAgICBpZiAoc291cmNlLm1hdGNoKC9eXFxcXFskJiUje31fXS8pKSB7XG4gICAgICByZXR1cm4gXCJ0YWdcIjtcbiAgICB9XG4gICAgLy8gd2hpdGUgc3BhY2UgY29udHJvbCBjaGFyYWN0ZXJzXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlxcXFxbLDshXFwvXS8pKSB7XG4gICAgICByZXR1cm4gXCJ0YWdcIjtcbiAgICB9XG4gICAgLy8gc3BlY2lhbCBtYXRoLW1vZGUgY2hhcmFjdGVyc1xuICAgIGlmIChzb3VyY2UubWF0Y2goL15bXFxeXyZdLykpIHtcbiAgICAgIHJldHVybiBcInRhZ1wiO1xuICAgIH1cbiAgICAvLyBub24tc3BlY2lhbCBjaGFyYWN0ZXJzXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlsrXFwtPD58PSxcXC9AISo6OydcImB+Iz9dLykpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAoc291cmNlLm1hdGNoKC9eKFxcZCtcXC5cXGQqfFxcZCpcXC5cXGQrfFxcZCspLykpIHtcbiAgICAgIHJldHVybiBcIm51bWJlclwiO1xuICAgIH1cbiAgICB2YXIgY2ggPSBzb3VyY2UubmV4dCgpO1xuICAgIGlmIChjaCA9PSBcIntcIiB8fCBjaCA9PSBcIn1cIiB8fCBjaCA9PSBcIltcIiB8fCBjaCA9PSBcIl1cIiB8fCBjaCA9PSBcIihcIiB8fCBjaCA9PSBcIilcIikge1xuICAgICAgcmV0dXJuIFwiYnJhY2tldFwiO1xuICAgIH1cblxuICAgIGlmIChjaCA9PSBcIiVcIikge1xuICAgICAgc291cmNlLnNraXBUb0VuZCgpO1xuICAgICAgcmV0dXJuIFwiY29tbWVudFwiO1xuICAgIH1cbiAgICByZXR1cm4gXCJlcnJvclwiO1xuICB9XG5cbiAgZnVuY3Rpb24gYmVnaW5QYXJhbXMoc291cmNlLCBzdGF0ZSkge1xuICAgIHZhciBjaCA9IHNvdXJjZS5wZWVrKCksIGxhc3RQbHVnO1xuICAgIGlmIChjaCA9PSAneycgfHwgY2ggPT0gJ1snKSB7XG4gICAgICBsYXN0UGx1ZyA9IHBlZWtDb21tYW5kKHN0YXRlKTtcbiAgICAgIGxhc3RQbHVnLm9wZW5CcmFja2V0KGNoKTtcbiAgICAgIHNvdXJjZS5lYXQoY2gpO1xuICAgICAgc2V0U3RhdGUoc3RhdGUsIG5vcm1hbCk7XG4gICAgICByZXR1cm4gXCJicmFja2V0XCI7XG4gICAgfVxuICAgIGlmICgvWyBcXHRcXHJdLy50ZXN0KGNoKSkge1xuICAgICAgc291cmNlLmVhdChjaCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgc2V0U3RhdGUoc3RhdGUsIG5vcm1hbCk7XG4gICAgcG9wQ29tbWFuZChzdGF0ZSk7XG5cbiAgICByZXR1cm4gbm9ybWFsKHNvdXJjZSwgc3RhdGUpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBuYW1lOiBcInN0ZXhcIixcbiAgICBzdGFydFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBmID0gbWF0aE1vZGUgPyBmdW5jdGlvbihzb3VyY2UsIHN0YXRlKXsgcmV0dXJuIGluTWF0aE1vZGUoc291cmNlLCBzdGF0ZSk7IH0gOiBub3JtYWw7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjbWRTdGF0ZTogW10sXG4gICAgICAgIGY6IGZcbiAgICAgIH07XG4gICAgfSxcbiAgICBjb3B5U3RhdGU6IGZ1bmN0aW9uKHMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNtZFN0YXRlOiBzLmNtZFN0YXRlLnNsaWNlKCksXG4gICAgICAgIGY6IHMuZlxuICAgICAgfTtcbiAgICB9LFxuICAgIHRva2VuOiBmdW5jdGlvbihzdHJlYW0sIHN0YXRlKSB7XG4gICAgICByZXR1cm4gc3RhdGUuZihzdHJlYW0sIHN0YXRlKTtcbiAgICB9LFxuICAgIGJsYW5rTGluZTogZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgIHN0YXRlLmYgPSBub3JtYWw7XG4gICAgICBzdGF0ZS5jbWRTdGF0ZS5sZW5ndGggPSAwO1xuICAgIH0sXG4gICAgbGFuZ3VhZ2VEYXRhOiB7XG4gICAgICBjb21tZW50VG9rZW5zOiB7bGluZTogXCIlXCJ9XG4gICAgfVxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IHN0ZXggPSBta1N0ZXgoZmFsc2UpXG5leHBvcnQgY29uc3Qgc3RleE1hdGggPSBta1N0ZXgodHJ1ZSlcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==