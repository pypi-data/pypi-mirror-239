"use strict";
(self["webpackChunk_jupyterlab_application_top"] = self["webpackChunk_jupyterlab_application_top"] || []).push([["node_modules_codemirror_legacy-modes_mode_tiddlywiki_js"],{

/***/ "../node_modules/@codemirror/legacy-modes/mode/tiddlywiki.js":
/*!*******************************************************************!*\
  !*** ../node_modules/@codemirror/legacy-modes/mode/tiddlywiki.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "tiddlyWiki": () => (/* binding */ tiddlyWiki)
/* harmony export */ });
// Tokenizer
var textwords = {};

var keywords = {
  "allTags": true, "closeAll": true, "list": true,
  "newJournal": true, "newTiddler": true,
  "permaview": true, "saveChanges": true,
  "search": true, "slider": true, "tabs": true,
  "tag": true, "tagging": true, "tags": true,
  "tiddler": true, "timeline": true,
  "today": true, "version": true, "option": true,
  "with": true, "filter": true
};

var isSpaceName = /[\w_\-]/i,
    reHR = /^\-\-\-\-+$/,                                 // <hr>
    reWikiCommentStart = /^\/\*\*\*$/,            // /***
    reWikiCommentStop = /^\*\*\*\/$/,             // ***/
    reBlockQuote = /^<<<$/,

    reJsCodeStart = /^\/\/\{\{\{$/,                       // //{{{ js block start
    reJsCodeStop = /^\/\/\}\}\}$/,                        // //}}} js stop
    reXmlCodeStart = /^<!--\{\{\{-->$/,           // xml block start
    reXmlCodeStop = /^<!--\}\}\}-->$/,            // xml stop

    reCodeBlockStart = /^\{\{\{$/,                        // {{{ TW text div block start
    reCodeBlockStop = /^\}\}\}$/,                 // }}} TW text stop

    reUntilCodeStop = /.*?\}\}\}/;

function chain(stream, state, f) {
  state.tokenize = f;
  return f(stream, state);
}

function tokenBase(stream, state) {
  var sol = stream.sol(), ch = stream.peek();

  state.block = false;        // indicates the start of a code block.

  // check start of  blocks
  if (sol && /[<\/\*{}\-]/.test(ch)) {
    if (stream.match(reCodeBlockStart)) {
      state.block = true;
      return chain(stream, state, twTokenCode);
    }
    if (stream.match(reBlockQuote))
      return 'quote';
    if (stream.match(reWikiCommentStart) || stream.match(reWikiCommentStop))
      return 'comment';
    if (stream.match(reJsCodeStart) || stream.match(reJsCodeStop) || stream.match(reXmlCodeStart) || stream.match(reXmlCodeStop))
      return 'comment';
    if (stream.match(reHR))
      return 'contentSeparator';
  }

  stream.next();
  if (sol && /[\/\*!#;:>|]/.test(ch)) {
    if (ch == "!") { // tw header
      stream.skipToEnd();
      return "header";
    }
    if (ch == "*") { // tw list
      stream.eatWhile('*');
      return "comment";
    }
    if (ch == "#") { // tw numbered list
      stream.eatWhile('#');
      return "comment";
    }
    if (ch == ";") { // definition list, term
      stream.eatWhile(';');
      return "comment";
    }
    if (ch == ":") { // definition list, description
      stream.eatWhile(':');
      return "comment";
    }
    if (ch == ">") { // single line quote
      stream.eatWhile(">");
      return "quote";
    }
    if (ch == '|')
      return 'header';
  }

  if (ch == '{' && stream.match('{{'))
    return chain(stream, state, twTokenCode);

  // rudimentary html:// file:// link matching. TW knows much more ...
  if (/[hf]/i.test(ch) &&
      /[ti]/i.test(stream.peek()) &&
      stream.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))
    return "link";

  // just a little string indicator, don't want to have the whole string covered
  if (ch == '"')
    return 'string';

  if (ch == '~')    // _no_ CamelCase indicator should be bold
    return 'brace';

  if (/[\[\]]/.test(ch) && stream.match(ch)) // check for [[..]]
    return 'brace';

  if (ch == "@") {    // check for space link. TODO fix @@...@@ highlighting
    stream.eatWhile(isSpaceName);
    return "link";
  }

  if (/\d/.test(ch)) {        // numbers
    stream.eatWhile(/\d/);
    return "number";
  }

  if (ch == "/") { // tw invisible comment
    if (stream.eat("%")) {
      return chain(stream, state, twTokenComment);
    } else if (stream.eat("/")) { //
      return chain(stream, state, twTokenEm);
    }
  }

  if (ch == "_" && stream.eat("_")) // tw underline
    return chain(stream, state, twTokenUnderline);

  // strikethrough and mdash handling
  if (ch == "-" && stream.eat("-")) {
    // if strikethrough looks ugly, change CSS.
    if (stream.peek() != ' ')
      return chain(stream, state, twTokenStrike);
    // mdash
    if (stream.peek() == ' ')
      return 'brace';
  }

  if (ch == "'" && stream.eat("'")) // tw bold
    return chain(stream, state, twTokenStrong);

  if (ch == "<" && stream.eat("<")) // tw macro
    return chain(stream, state, twTokenMacro);

  // core macro handling
  stream.eatWhile(/[\w\$_]/);
  return textwords.propertyIsEnumerable(stream.current()) ? "keyword" : null
}

// tw invisible comment
function twTokenComment(stream, state) {
  var maybeEnd = false, ch;
  while (ch = stream.next()) {
    if (ch == "/" && maybeEnd) {
      state.tokenize = tokenBase;
      break;
    }
    maybeEnd = (ch == "%");
  }
  return "comment";
}

// tw strong / bold
function twTokenStrong(stream, state) {
  var maybeEnd = false,
      ch;
  while (ch = stream.next()) {
    if (ch == "'" && maybeEnd) {
      state.tokenize = tokenBase;
      break;
    }
    maybeEnd = (ch == "'");
  }
  return "strong";
}

// tw code
function twTokenCode(stream, state) {
  var sb = state.block;

  if (sb && stream.current()) {
    return "comment";
  }

  if (!sb && stream.match(reUntilCodeStop)) {
    state.tokenize = tokenBase;
    return "comment";
  }

  if (sb && stream.sol() && stream.match(reCodeBlockStop)) {
    state.tokenize = tokenBase;
    return "comment";
  }

  stream.next();
  return "comment";
}

// tw em / italic
function twTokenEm(stream, state) {
  var maybeEnd = false,
      ch;
  while (ch = stream.next()) {
    if (ch == "/" && maybeEnd) {
      state.tokenize = tokenBase;
      break;
    }
    maybeEnd = (ch == "/");
  }
  return "emphasis";
}

// tw underlined text
function twTokenUnderline(stream, state) {
  var maybeEnd = false,
      ch;
  while (ch = stream.next()) {
    if (ch == "_" && maybeEnd) {
      state.tokenize = tokenBase;
      break;
    }
    maybeEnd = (ch == "_");
  }
  return "link";
}

// tw strike through text looks ugly
// change CSS if needed
function twTokenStrike(stream, state) {
  var maybeEnd = false, ch;

  while (ch = stream.next()) {
    if (ch == "-" && maybeEnd) {
      state.tokenize = tokenBase;
      break;
    }
    maybeEnd = (ch == "-");
  }
  return "deleted";
}

// macro
function twTokenMacro(stream, state) {
  if (stream.current() == '<<') {
    return 'meta';
  }

  var ch = stream.next();
  if (!ch) {
    state.tokenize = tokenBase;
    return null;
  }
  if (ch == ">") {
    if (stream.peek() == '>') {
      stream.next();
      state.tokenize = tokenBase;
      return "meta";
    }
  }

  stream.eatWhile(/[\w\$_]/);
  return keywords.propertyIsEnumerable(stream.current()) ? "keyword" : null
}

// Interface
const tiddlyWiki = {
  name: "tiddlywiki",

  startState: function () {
    return {tokenize: tokenBase};
  },

  token: function (stream, state) {
    if (stream.eatSpace()) return null;
    var style = state.tokenize(stream, state);
    return style;
  }
};



/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2NvZGVtaXJyb3JfbGVnYWN5LW1vZGVzX21vZGVfdGlkZGx5d2lraV9qcy40MzMxYmE4ZTM5MDM4MTFmMGM5Yi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDRCQUE0QixFQUFFLEVBQUUsbUNBQW1DO0FBQ25FLDJCQUEyQixFQUFFLEVBQUUsb0NBQW9DO0FBQ25FLDZCQUE2QixFQUFFLEVBQUU7QUFDakMsNEJBQTRCLEVBQUUsRUFBRTs7QUFFaEMsMkJBQTJCLEVBQUUsRUFBRSxrQ0FBa0M7QUFDakUsMEJBQTBCLEVBQUUsRUFBRSwyQkFBMkI7O0FBRXpELDRCQUE0QixFQUFFLEVBQUU7O0FBRWhDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsOEJBQThCOztBQUU5QjtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQjtBQUN0QixxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsS0FBSztBQUNyQix3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGNBQWMscUJBQXFCO0FBQ25DOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRTtBQUNwRTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLE1BQU0sNEJBQTRCO0FBQ2xDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDTztBQUNQOztBQUVBO0FBQ0EsWUFBWTtBQUNaLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4uL25vZGVfbW9kdWxlcy9AY29kZW1pcnJvci9sZWdhY3ktbW9kZXMvbW9kZS90aWRkbHl3aWtpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRva2VuaXplclxudmFyIHRleHR3b3JkcyA9IHt9O1xuXG52YXIga2V5d29yZHMgPSB7XG4gIFwiYWxsVGFnc1wiOiB0cnVlLCBcImNsb3NlQWxsXCI6IHRydWUsIFwibGlzdFwiOiB0cnVlLFxuICBcIm5ld0pvdXJuYWxcIjogdHJ1ZSwgXCJuZXdUaWRkbGVyXCI6IHRydWUsXG4gIFwicGVybWF2aWV3XCI6IHRydWUsIFwic2F2ZUNoYW5nZXNcIjogdHJ1ZSxcbiAgXCJzZWFyY2hcIjogdHJ1ZSwgXCJzbGlkZXJcIjogdHJ1ZSwgXCJ0YWJzXCI6IHRydWUsXG4gIFwidGFnXCI6IHRydWUsIFwidGFnZ2luZ1wiOiB0cnVlLCBcInRhZ3NcIjogdHJ1ZSxcbiAgXCJ0aWRkbGVyXCI6IHRydWUsIFwidGltZWxpbmVcIjogdHJ1ZSxcbiAgXCJ0b2RheVwiOiB0cnVlLCBcInZlcnNpb25cIjogdHJ1ZSwgXCJvcHRpb25cIjogdHJ1ZSxcbiAgXCJ3aXRoXCI6IHRydWUsIFwiZmlsdGVyXCI6IHRydWVcbn07XG5cbnZhciBpc1NwYWNlTmFtZSA9IC9bXFx3X1xcLV0vaSxcbiAgICByZUhSID0gL15cXC1cXC1cXC1cXC0rJC8sICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPGhyPlxuICAgIHJlV2lraUNvbW1lbnRTdGFydCA9IC9eXFwvXFwqXFwqXFwqJC8sICAgICAgICAgICAgLy8gLyoqKlxuICAgIHJlV2lraUNvbW1lbnRTdG9wID0gL15cXCpcXCpcXCpcXC8kLywgICAgICAgICAgICAgLy8gKioqL1xuICAgIHJlQmxvY2tRdW90ZSA9IC9ePDw8JC8sXG5cbiAgICByZUpzQ29kZVN0YXJ0ID0gL15cXC9cXC9cXHtcXHtcXHskLywgICAgICAgICAgICAgICAgICAgICAgIC8vIC8ve3t7IGpzIGJsb2NrIHN0YXJ0XG4gICAgcmVKc0NvZGVTdG9wID0gL15cXC9cXC9cXH1cXH1cXH0kLywgICAgICAgICAgICAgICAgICAgICAgICAvLyAvL319fSBqcyBzdG9wXG4gICAgcmVYbWxDb2RlU3RhcnQgPSAvXjwhLS1cXHtcXHtcXHstLT4kLywgICAgICAgICAgIC8vIHhtbCBibG9jayBzdGFydFxuICAgIHJlWG1sQ29kZVN0b3AgPSAvXjwhLS1cXH1cXH1cXH0tLT4kLywgICAgICAgICAgICAvLyB4bWwgc3RvcFxuXG4gICAgcmVDb2RlQmxvY2tTdGFydCA9IC9eXFx7XFx7XFx7JC8sICAgICAgICAgICAgICAgICAgICAgICAgLy8ge3t7IFRXIHRleHQgZGl2IGJsb2NrIHN0YXJ0XG4gICAgcmVDb2RlQmxvY2tTdG9wID0gL15cXH1cXH1cXH0kLywgICAgICAgICAgICAgICAgIC8vIH19fSBUVyB0ZXh0IHN0b3BcblxuICAgIHJlVW50aWxDb2RlU3RvcCA9IC8uKj9cXH1cXH1cXH0vO1xuXG5mdW5jdGlvbiBjaGFpbihzdHJlYW0sIHN0YXRlLCBmKSB7XG4gIHN0YXRlLnRva2VuaXplID0gZjtcbiAgcmV0dXJuIGYoc3RyZWFtLCBzdGF0ZSk7XG59XG5cbmZ1bmN0aW9uIHRva2VuQmFzZShzdHJlYW0sIHN0YXRlKSB7XG4gIHZhciBzb2wgPSBzdHJlYW0uc29sKCksIGNoID0gc3RyZWFtLnBlZWsoKTtcblxuICBzdGF0ZS5ibG9jayA9IGZhbHNlOyAgICAgICAgLy8gaW5kaWNhdGVzIHRoZSBzdGFydCBvZiBhIGNvZGUgYmxvY2suXG5cbiAgLy8gY2hlY2sgc3RhcnQgb2YgIGJsb2Nrc1xuICBpZiAoc29sICYmIC9bPFxcL1xcKnt9XFwtXS8udGVzdChjaCkpIHtcbiAgICBpZiAoc3RyZWFtLm1hdGNoKHJlQ29kZUJsb2NrU3RhcnQpKSB7XG4gICAgICBzdGF0ZS5ibG9jayA9IHRydWU7XG4gICAgICByZXR1cm4gY2hhaW4oc3RyZWFtLCBzdGF0ZSwgdHdUb2tlbkNvZGUpO1xuICAgIH1cbiAgICBpZiAoc3RyZWFtLm1hdGNoKHJlQmxvY2tRdW90ZSkpXG4gICAgICByZXR1cm4gJ3F1b3RlJztcbiAgICBpZiAoc3RyZWFtLm1hdGNoKHJlV2lraUNvbW1lbnRTdGFydCkgfHwgc3RyZWFtLm1hdGNoKHJlV2lraUNvbW1lbnRTdG9wKSlcbiAgICAgIHJldHVybiAnY29tbWVudCc7XG4gICAgaWYgKHN0cmVhbS5tYXRjaChyZUpzQ29kZVN0YXJ0KSB8fCBzdHJlYW0ubWF0Y2gocmVKc0NvZGVTdG9wKSB8fCBzdHJlYW0ubWF0Y2gocmVYbWxDb2RlU3RhcnQpIHx8IHN0cmVhbS5tYXRjaChyZVhtbENvZGVTdG9wKSlcbiAgICAgIHJldHVybiAnY29tbWVudCc7XG4gICAgaWYgKHN0cmVhbS5tYXRjaChyZUhSKSlcbiAgICAgIHJldHVybiAnY29udGVudFNlcGFyYXRvcic7XG4gIH1cblxuICBzdHJlYW0ubmV4dCgpO1xuICBpZiAoc29sICYmIC9bXFwvXFwqISM7Oj58XS8udGVzdChjaCkpIHtcbiAgICBpZiAoY2ggPT0gXCIhXCIpIHsgLy8gdHcgaGVhZGVyXG4gICAgICBzdHJlYW0uc2tpcFRvRW5kKCk7XG4gICAgICByZXR1cm4gXCJoZWFkZXJcIjtcbiAgICB9XG4gICAgaWYgKGNoID09IFwiKlwiKSB7IC8vIHR3IGxpc3RcbiAgICAgIHN0cmVhbS5lYXRXaGlsZSgnKicpO1xuICAgICAgcmV0dXJuIFwiY29tbWVudFwiO1xuICAgIH1cbiAgICBpZiAoY2ggPT0gXCIjXCIpIHsgLy8gdHcgbnVtYmVyZWQgbGlzdFxuICAgICAgc3RyZWFtLmVhdFdoaWxlKCcjJyk7XG4gICAgICByZXR1cm4gXCJjb21tZW50XCI7XG4gICAgfVxuICAgIGlmIChjaCA9PSBcIjtcIikgeyAvLyBkZWZpbml0aW9uIGxpc3QsIHRlcm1cbiAgICAgIHN0cmVhbS5lYXRXaGlsZSgnOycpO1xuICAgICAgcmV0dXJuIFwiY29tbWVudFwiO1xuICAgIH1cbiAgICBpZiAoY2ggPT0gXCI6XCIpIHsgLy8gZGVmaW5pdGlvbiBsaXN0LCBkZXNjcmlwdGlvblxuICAgICAgc3RyZWFtLmVhdFdoaWxlKCc6Jyk7XG4gICAgICByZXR1cm4gXCJjb21tZW50XCI7XG4gICAgfVxuICAgIGlmIChjaCA9PSBcIj5cIikgeyAvLyBzaW5nbGUgbGluZSBxdW90ZVxuICAgICAgc3RyZWFtLmVhdFdoaWxlKFwiPlwiKTtcbiAgICAgIHJldHVybiBcInF1b3RlXCI7XG4gICAgfVxuICAgIGlmIChjaCA9PSAnfCcpXG4gICAgICByZXR1cm4gJ2hlYWRlcic7XG4gIH1cblxuICBpZiAoY2ggPT0gJ3snICYmIHN0cmVhbS5tYXRjaCgne3snKSlcbiAgICByZXR1cm4gY2hhaW4oc3RyZWFtLCBzdGF0ZSwgdHdUb2tlbkNvZGUpO1xuXG4gIC8vIHJ1ZGltZW50YXJ5IGh0bWw6Ly8gZmlsZTovLyBsaW5rIG1hdGNoaW5nLiBUVyBrbm93cyBtdWNoIG1vcmUgLi4uXG4gIGlmICgvW2hmXS9pLnRlc3QoY2gpICYmXG4gICAgICAvW3RpXS9pLnRlc3Qoc3RyZWFtLnBlZWsoKSkgJiZcbiAgICAgIHN0cmVhbS5tYXRjaCgvXFxiKHR0cHM/fHRwfGlsZSk6XFwvXFwvW1xcLUEtWjAtOSsmQCNcXC8lPz1+X3wkITosLjtdKltBLVowLTkrJkAjXFwvJT1+X3wkXS9pKSlcbiAgICByZXR1cm4gXCJsaW5rXCI7XG5cbiAgLy8ganVzdCBhIGxpdHRsZSBzdHJpbmcgaW5kaWNhdG9yLCBkb24ndCB3YW50IHRvIGhhdmUgdGhlIHdob2xlIHN0cmluZyBjb3ZlcmVkXG4gIGlmIChjaCA9PSAnXCInKVxuICAgIHJldHVybiAnc3RyaW5nJztcblxuICBpZiAoY2ggPT0gJ34nKSAgICAvLyBfbm9fIENhbWVsQ2FzZSBpbmRpY2F0b3Igc2hvdWxkIGJlIGJvbGRcbiAgICByZXR1cm4gJ2JyYWNlJztcblxuICBpZiAoL1tcXFtcXF1dLy50ZXN0KGNoKSAmJiBzdHJlYW0ubWF0Y2goY2gpKSAvLyBjaGVjayBmb3IgW1suLl1dXG4gICAgcmV0dXJuICdicmFjZSc7XG5cbiAgaWYgKGNoID09IFwiQFwiKSB7ICAgIC8vIGNoZWNrIGZvciBzcGFjZSBsaW5rLiBUT0RPIGZpeCBAQC4uLkBAIGhpZ2hsaWdodGluZ1xuICAgIHN0cmVhbS5lYXRXaGlsZShpc1NwYWNlTmFtZSk7XG4gICAgcmV0dXJuIFwibGlua1wiO1xuICB9XG5cbiAgaWYgKC9cXGQvLnRlc3QoY2gpKSB7ICAgICAgICAvLyBudW1iZXJzXG4gICAgc3RyZWFtLmVhdFdoaWxlKC9cXGQvKTtcbiAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgfVxuXG4gIGlmIChjaCA9PSBcIi9cIikgeyAvLyB0dyBpbnZpc2libGUgY29tbWVudFxuICAgIGlmIChzdHJlYW0uZWF0KFwiJVwiKSkge1xuICAgICAgcmV0dXJuIGNoYWluKHN0cmVhbSwgc3RhdGUsIHR3VG9rZW5Db21tZW50KTtcbiAgICB9IGVsc2UgaWYgKHN0cmVhbS5lYXQoXCIvXCIpKSB7IC8vXG4gICAgICByZXR1cm4gY2hhaW4oc3RyZWFtLCBzdGF0ZSwgdHdUb2tlbkVtKTtcbiAgICB9XG4gIH1cblxuICBpZiAoY2ggPT0gXCJfXCIgJiYgc3RyZWFtLmVhdChcIl9cIikpIC8vIHR3IHVuZGVybGluZVxuICAgIHJldHVybiBjaGFpbihzdHJlYW0sIHN0YXRlLCB0d1Rva2VuVW5kZXJsaW5lKTtcblxuICAvLyBzdHJpa2V0aHJvdWdoIGFuZCBtZGFzaCBoYW5kbGluZ1xuICBpZiAoY2ggPT0gXCItXCIgJiYgc3RyZWFtLmVhdChcIi1cIikpIHtcbiAgICAvLyBpZiBzdHJpa2V0aHJvdWdoIGxvb2tzIHVnbHksIGNoYW5nZSBDU1MuXG4gICAgaWYgKHN0cmVhbS5wZWVrKCkgIT0gJyAnKVxuICAgICAgcmV0dXJuIGNoYWluKHN0cmVhbSwgc3RhdGUsIHR3VG9rZW5TdHJpa2UpO1xuICAgIC8vIG1kYXNoXG4gICAgaWYgKHN0cmVhbS5wZWVrKCkgPT0gJyAnKVxuICAgICAgcmV0dXJuICdicmFjZSc7XG4gIH1cblxuICBpZiAoY2ggPT0gXCInXCIgJiYgc3RyZWFtLmVhdChcIidcIikpIC8vIHR3IGJvbGRcbiAgICByZXR1cm4gY2hhaW4oc3RyZWFtLCBzdGF0ZSwgdHdUb2tlblN0cm9uZyk7XG5cbiAgaWYgKGNoID09IFwiPFwiICYmIHN0cmVhbS5lYXQoXCI8XCIpKSAvLyB0dyBtYWNyb1xuICAgIHJldHVybiBjaGFpbihzdHJlYW0sIHN0YXRlLCB0d1Rva2VuTWFjcm8pO1xuXG4gIC8vIGNvcmUgbWFjcm8gaGFuZGxpbmdcbiAgc3RyZWFtLmVhdFdoaWxlKC9bXFx3XFwkX10vKTtcbiAgcmV0dXJuIHRleHR3b3Jkcy5wcm9wZXJ0eUlzRW51bWVyYWJsZShzdHJlYW0uY3VycmVudCgpKSA/IFwia2V5d29yZFwiIDogbnVsbFxufVxuXG4vLyB0dyBpbnZpc2libGUgY29tbWVudFxuZnVuY3Rpb24gdHdUb2tlbkNvbW1lbnQoc3RyZWFtLCBzdGF0ZSkge1xuICB2YXIgbWF5YmVFbmQgPSBmYWxzZSwgY2g7XG4gIHdoaWxlIChjaCA9IHN0cmVhbS5uZXh0KCkpIHtcbiAgICBpZiAoY2ggPT0gXCIvXCIgJiYgbWF5YmVFbmQpIHtcbiAgICAgIHN0YXRlLnRva2VuaXplID0gdG9rZW5CYXNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIG1heWJlRW5kID0gKGNoID09IFwiJVwiKTtcbiAgfVxuICByZXR1cm4gXCJjb21tZW50XCI7XG59XG5cbi8vIHR3IHN0cm9uZyAvIGJvbGRcbmZ1bmN0aW9uIHR3VG9rZW5TdHJvbmcoc3RyZWFtLCBzdGF0ZSkge1xuICB2YXIgbWF5YmVFbmQgPSBmYWxzZSxcbiAgICAgIGNoO1xuICB3aGlsZSAoY2ggPSBzdHJlYW0ubmV4dCgpKSB7XG4gICAgaWYgKGNoID09IFwiJ1wiICYmIG1heWJlRW5kKSB7XG4gICAgICBzdGF0ZS50b2tlbml6ZSA9IHRva2VuQmFzZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBtYXliZUVuZCA9IChjaCA9PSBcIidcIik7XG4gIH1cbiAgcmV0dXJuIFwic3Ryb25nXCI7XG59XG5cbi8vIHR3IGNvZGVcbmZ1bmN0aW9uIHR3VG9rZW5Db2RlKHN0cmVhbSwgc3RhdGUpIHtcbiAgdmFyIHNiID0gc3RhdGUuYmxvY2s7XG5cbiAgaWYgKHNiICYmIHN0cmVhbS5jdXJyZW50KCkpIHtcbiAgICByZXR1cm4gXCJjb21tZW50XCI7XG4gIH1cblxuICBpZiAoIXNiICYmIHN0cmVhbS5tYXRjaChyZVVudGlsQ29kZVN0b3ApKSB7XG4gICAgc3RhdGUudG9rZW5pemUgPSB0b2tlbkJhc2U7XG4gICAgcmV0dXJuIFwiY29tbWVudFwiO1xuICB9XG5cbiAgaWYgKHNiICYmIHN0cmVhbS5zb2woKSAmJiBzdHJlYW0ubWF0Y2gocmVDb2RlQmxvY2tTdG9wKSkge1xuICAgIHN0YXRlLnRva2VuaXplID0gdG9rZW5CYXNlO1xuICAgIHJldHVybiBcImNvbW1lbnRcIjtcbiAgfVxuXG4gIHN0cmVhbS5uZXh0KCk7XG4gIHJldHVybiBcImNvbW1lbnRcIjtcbn1cblxuLy8gdHcgZW0gLyBpdGFsaWNcbmZ1bmN0aW9uIHR3VG9rZW5FbShzdHJlYW0sIHN0YXRlKSB7XG4gIHZhciBtYXliZUVuZCA9IGZhbHNlLFxuICAgICAgY2g7XG4gIHdoaWxlIChjaCA9IHN0cmVhbS5uZXh0KCkpIHtcbiAgICBpZiAoY2ggPT0gXCIvXCIgJiYgbWF5YmVFbmQpIHtcbiAgICAgIHN0YXRlLnRva2VuaXplID0gdG9rZW5CYXNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIG1heWJlRW5kID0gKGNoID09IFwiL1wiKTtcbiAgfVxuICByZXR1cm4gXCJlbXBoYXNpc1wiO1xufVxuXG4vLyB0dyB1bmRlcmxpbmVkIHRleHRcbmZ1bmN0aW9uIHR3VG9rZW5VbmRlcmxpbmUoc3RyZWFtLCBzdGF0ZSkge1xuICB2YXIgbWF5YmVFbmQgPSBmYWxzZSxcbiAgICAgIGNoO1xuICB3aGlsZSAoY2ggPSBzdHJlYW0ubmV4dCgpKSB7XG4gICAgaWYgKGNoID09IFwiX1wiICYmIG1heWJlRW5kKSB7XG4gICAgICBzdGF0ZS50b2tlbml6ZSA9IHRva2VuQmFzZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBtYXliZUVuZCA9IChjaCA9PSBcIl9cIik7XG4gIH1cbiAgcmV0dXJuIFwibGlua1wiO1xufVxuXG4vLyB0dyBzdHJpa2UgdGhyb3VnaCB0ZXh0IGxvb2tzIHVnbHlcbi8vIGNoYW5nZSBDU1MgaWYgbmVlZGVkXG5mdW5jdGlvbiB0d1Rva2VuU3RyaWtlKHN0cmVhbSwgc3RhdGUpIHtcbiAgdmFyIG1heWJlRW5kID0gZmFsc2UsIGNoO1xuXG4gIHdoaWxlIChjaCA9IHN0cmVhbS5uZXh0KCkpIHtcbiAgICBpZiAoY2ggPT0gXCItXCIgJiYgbWF5YmVFbmQpIHtcbiAgICAgIHN0YXRlLnRva2VuaXplID0gdG9rZW5CYXNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIG1heWJlRW5kID0gKGNoID09IFwiLVwiKTtcbiAgfVxuICByZXR1cm4gXCJkZWxldGVkXCI7XG59XG5cbi8vIG1hY3JvXG5mdW5jdGlvbiB0d1Rva2VuTWFjcm8oc3RyZWFtLCBzdGF0ZSkge1xuICBpZiAoc3RyZWFtLmN1cnJlbnQoKSA9PSAnPDwnKSB7XG4gICAgcmV0dXJuICdtZXRhJztcbiAgfVxuXG4gIHZhciBjaCA9IHN0cmVhbS5uZXh0KCk7XG4gIGlmICghY2gpIHtcbiAgICBzdGF0ZS50b2tlbml6ZSA9IHRva2VuQmFzZTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoY2ggPT0gXCI+XCIpIHtcbiAgICBpZiAoc3RyZWFtLnBlZWsoKSA9PSAnPicpIHtcbiAgICAgIHN0cmVhbS5uZXh0KCk7XG4gICAgICBzdGF0ZS50b2tlbml6ZSA9IHRva2VuQmFzZTtcbiAgICAgIHJldHVybiBcIm1ldGFcIjtcbiAgICB9XG4gIH1cblxuICBzdHJlYW0uZWF0V2hpbGUoL1tcXHdcXCRfXS8pO1xuICByZXR1cm4ga2V5d29yZHMucHJvcGVydHlJc0VudW1lcmFibGUoc3RyZWFtLmN1cnJlbnQoKSkgPyBcImtleXdvcmRcIiA6IG51bGxcbn1cblxuLy8gSW50ZXJmYWNlXG5leHBvcnQgY29uc3QgdGlkZGx5V2lraSA9IHtcbiAgbmFtZTogXCJ0aWRkbHl3aWtpXCIsXG5cbiAgc3RhcnRTdGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7dG9rZW5pemU6IHRva2VuQmFzZX07XG4gIH0sXG5cbiAgdG9rZW46IGZ1bmN0aW9uIChzdHJlYW0sIHN0YXRlKSB7XG4gICAgaWYgKHN0cmVhbS5lYXRTcGFjZSgpKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgc3R5bGUgPSBzdGF0ZS50b2tlbml6ZShzdHJlYW0sIHN0YXRlKTtcbiAgICByZXR1cm4gc3R5bGU7XG4gIH1cbn07XG5cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==